<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ward Search</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  </head>
  <body>
    <header>
        <nav>
              <a href="#">
                <img src="img/brand.png">
                <p>Edmonton Transit Service</p>
              </a>
          </nav>
          <h1>Transit Bus Stop Route Maps</h1>
    </header>
    <main>
      <script>
        var selectedCheckboxes = JSON.parse(sessionStorage.getItem('selectedCheckboxes'));
        console.log(selectedCheckboxes)
      </script>
        <section class="results">
            <!--Generate divs for each result. Sample below:-->
            <div class="result-box">
              <!-- <script>
                // save image from api 
                // Function to call the API, retrieve the image, and save it

                apiUrl = "http://127.0.0.1:5000/generate_png?stop=" + selectedCheckboxes[0];
                console.log(apiUrl);
                imageName = "stop.png";

                function fetchAndSaveImage(apiUrl, imageName) {
                    fetch(apiUrl)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.blob();
                    })
                    .then(imageBlob => {
                        // Create a new FileReader
                        var reader = new FileReader();
                        reader.onload = function() {
                            // Once the image is loaded, save it to local storage
                            localStorage.setItem(imageName, reader.result);
                            console.log('Image saved:', imageName);
                        };
                        // Read the image blob as Data URL
                        reader.readAsDataURL(imageBlob);
                    })
                    .catch(error => {
                        console.error('Error fetching image:', error);
                    });
                }

                fetchAndSaveImage(apiUrl, imageName);
              </script> -->
                <img src="img/stop.png" alt="Isn't she a beauty?">
                <span class="stop-tag">Stop ID: </span>
            </div>
        </section>
        <section class="download">
            <a href="index.html" class="download-btn">Download Maps</a>
        </section>
    </main>
    <script src="js/maps.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>